@let rowClass = "sui flex-x gap-2 grow-1";
@if (animal(); as animal) {
  <div class="sui save-content-buttons flex-x gap-2 jc-end">
    <button class="primary" data-testid="btn-save-animal" (click)="save()">Speichern</button>
    @let isPublished = animal.PublishedAt?.Valid;
    <button [class.warning]="!isPublished" [class.success]="isPublished" (click)="togglePublished()">{{ animal.PublishedAt?.Valid ? 'Depublizieren' : 'Publizieren' }}</button>
    <button class="warning" (click)="delete()">Löschen</button>
  </div>
  <div class="editor-layout sui p-3">
    <div data-testid="form-animal-editor" class="sui flex-x gap-3 grow-1">
      <app-image-picker-single label="Portrait" idName="portrait" [(twoWayModel)]="animal.Portrait"/>
      <form class="sui flex-y gap-2 grow-1 pr-1">
        <div [class]="rowClass">
          <app-text-input class="sui grow-1" idName="animal-name" label="Name" [(twoWayModel)]="animal.Name"/>
          <app-radio-buttons-input idName="gender" label="Geschlecht" [options]="['male', 'female']" [optionTranslations]="['Männlich', 'Weiblich']"
                                   [(twoWayModel)]="animal.Gender"/>
        </div>
        <app-text-input
          class="description" idName="description" label="Beschreibung" [long]="true"
          [(twoWayModel)]="animal.Description"
          style="width: 100%;"
          explanation="Kurzer Text, der im Steckbrief oben unter jedem Tier angezeigt wird"/>
        <div [class]="rowClass">
          <app-checkbox-input idName="castrated" label="Kastriert" [(nullBoolModel)]="animal.Castrated"/>
          <app-date-picker idName="birthday" label="Geboren ca." [(twoWayModelISOString)]="animal.Birthday"/>
          <app-number-input idName="size" label="Schulterhöhe in cm" [(twoWayModel)]="animal.ShoulderHeightCm"/>
        </div>

        @if(animalKinds) {
          <app-select-input idName="animalKind" label="Art" [(twoWayModel)]="animal.AnimalKind" [options]="animalKinds"/>
        }
      </form>
    </div>
    <br>
    <br>
    <app-last-edited [entry]="animal"/>
    <hr class="sui my-3">

    @if (animal.ArticleID) {
      <app-article-editor [articleId]="animal.ArticleID ?? ''" [saveArticle]="saveArticle$" class="sui flex-y grow-1 mt-2"/>
    } @else {
      <div class="sui flex-x gap-2">
        <button data-testid="btn-create-article-for-animal" (click)="createArticle()" class="secondary">Artikel erstellen</button>
        <button data-testid="btn-assign-article-to-animal" (click)="assignExistingArticle()" class="secondary">Existierendem Tierartikel zuweisen*</button>
      </div>
      <br>
      <p><b>*Existierendem Tierartikel zuweisen</b> ist z.B. für Geschwister gedacht, für die man nur einen Artikel schreiben will, aber den Steckbrief trotzdem separat pflegen
        möchte.</p>
    }
  </div>
} @else {
  404 Tier nicht gefunden
}
