---
import { cms } from '@shared/cms/sheltify-access.ts';
import AnimalCard from '@shared/components/AnimalCard.astro';
import { animalsByArticleId } from 'sheltify-lib/animal-util.ts';
import type { SectionAnimalList, SectionHero } from 'sheltify-lib/article-types.ts';
import type { CmsAnimal } from 'sheltify-lib/cms-types.ts';
interface Props {
  section: SectionAnimalList,
}

const {section} = Astro.props;

const filteredAnimals = await cms.getFilteredAnimals(section.Content);
const allAnimalsByArticle = animalsByArticleId(await cms.animals);

function getLink(animal: CmsAnimal) {
  const animalsInArticle = allAnimalsByArticle[animal.ArticleID ?? ''];
  const names = animalsInArticle.map((animal) => animal.Name).join('-');
  return `/${animalsInArticle[0].AnimalKind}/${names}`
}

---

<div class="sui flex-x gap-2 wrap">
{
  filteredAnimals.map(animal => {
    return <a href={getLink(animal)}><AnimalCard animal={animal}/></a>;
  })
}
</div>



<style is:global lang="scss">
  .article {
    .hero-container {
      display: block;
      position: relative;
      height: var(--hero-height);
      overflow: hidden;

      &.top-hero {
        height: var(--hero-top-height);

        .hero-img {
          height: var(--hero-top-height);
        }
      }

      .hero-scroller {
        transition: transform 1s;
      }

      .hero-img {
        height: var(--hero-height);
        width: 100%;
        max-height: 100dvh;
        position: absolute;
      }

      h1 {
        position: absolute;
        z-index: 1;
        bottom: 20%;
        width: 100%;
        padding-left: 20%;
      }
    }
  }
</style>